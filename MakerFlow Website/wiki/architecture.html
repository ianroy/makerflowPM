<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Wiki | Architecture</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&family=Source+Sans+3:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/website/assets/site.css" />
  </head>
  <body class="site-root">
    <header class="site-header">
      <a class="brand-mark" href="/website/">
        <img src="/website/assets/logo.svg" alt="MakerFlow PM logo" />
        <span><strong>MakerFlow PM</strong><em>Architecture</em></span>
      </a>
      <nav class="site-nav"><a href="/website/wiki/">Wiki Home</a><a href="/login">App Login</a></nav>
      <div class="site-actions"><a class="btn" href="/login">Launch App</a></div>
    </header>
    <main class="wiki-layout">
      <aside class="wiki-nav">
        <h2>Wiki Pages</h2>
        <a href="/website/wiki/">Overview</a>
        <a href="/website/wiki/getting-started.html">Getting Started</a>
        <a href="/website/wiki/deployment.html">Deployment</a>
        <a href="/website/wiki/architecture.html" aria-current="page">Architecture</a>
        <a href="/website/wiki/data-model.html">Data Model</a>
        <a href="/website/wiki/api-routes.html">API and Routes</a>
        <a href="/website/wiki/operations.html">Operations</a>
        <a href="/website/wiki/file-map.html">Full File Map</a>
        <a href="/website/wiki/release-notes.html">Release Notes</a>
      </aside>
      <article class="wiki-content">
        <h1>Architecture + Version Matrix</h1>

        <h2>Core Architecture</h2>
        <ul>
          <li>Backend: Python WSGI app in <code>app/server.py</code></li>
          <li>Frontend: server-rendered HTML with progressive enhancement in <code>app/static/app.js</code></li>
          <li>Style system: <code>app/static/style.css</code></li>
          <li>Persistence: SQLite by default, PostgreSQL when <code>MAKERSPACE_DATABASE_URL</code> is set</li>
        </ul>

        <h2>Software Version Inventory</h2>
        <ul>
          <li>Python: <code>3.11.9</code></li>
          <li>Gunicorn: <code>&gt;=21.0.0</code></li>
          <li>Flask: <code>&gt;=3.0.0</code></li>
          <li>Werkzeug: <code>&gt;=3.0.0</code></li>
          <li>psycopg[binary]: <code>&gt;=3.1.18</code></li>
          <li>pypdf: <code>&gt;=4.3.1</code></li>
        </ul>

        <h2>Request Flow</h2>
        <ol>
          <li>WSGI entrypoint resolves path and user session context.</li>
          <li>CSRF and role gates apply to mutating requests.</li>
          <li>Organization-scoped SQL executes.</li>
          <li>HTML or JSON response is returned with security headers.</li>
        </ol>

        <h2>Role Model</h2>
        <ol>
          <li><code>viewer</code></li>
          <li><code>student</code></li>
          <li><code>staff</code></li>
          <li><code>manager</code></li>
          <li><code>workspace_admin</code></li>
          <li><code>owner</code></li>
        </ol>

        <h2>Build and Ops Toolchain</h2>
        <ul>
          <li>Git + GitHub + GitHub Desktop</li>
          <li>DigitalOcean (Droplet and App Platform)</li>
          <li>DigitalOcean Managed PostgreSQL</li>
          <li>OpenAI Codex (GPT-5.3 workflow) for iterative engineering and documentation</li>
        </ul>
      </article>
    </main>
  </body>
</html>
